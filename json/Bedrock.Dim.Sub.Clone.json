{"Parameters": [{"Prompt": "Dimension where the subset exists", "Type": "String", "Value": "", "Name": "pDimension"}, {"Prompt": "Source Subset", "Type": "String", "Value": "", "Name": "pSourceSub"}, {"Prompt": "Target Subset", "Type": "String", "Value": "", "Name": "pTargetSub"}, {"Prompt": "Debug Mode", "Type": "Numeric", "Value": 0, "Name": "pDebug"}], "DataProcedure": "#****Begin: Generated Statements***\r\n#****End: Generated Statements****\r\n\r\n#****Begin: Generated Statements***\r\n#****End: Generated Statements****", "Variables": [{"Position": 1, "EndByte": 0, "StartByte": 0, "Type": "String", "Name": "vElement"}], "HasSecurityAccess": false, "UIData": "CubeAction=1511\fDataAction=1503\fCubeLogChanges=0\f", "Name": "Bedrock.Dim.Sub.Clone", "PrologProcedure": "\r\n#****Begin: Generated Statements***\r\n#****End: Generated Statements****\r\n\r\n################################################################\r\n##~~Copyright bedrocktm1.org 2013 www.bedrocktm1.org/how-to-licence.php Ver 3.0.2~~##\r\n################################################################\r\n\r\n# This process will create a copy of subset\r\n\r\n### Constants ###\r\n\r\ncProcess = 'Bedrock.Dim.Sub.Clone';\r\ncTimeStamp = TimSt( Now, '\\Y\\m\\d\\h\\i\\s' );\r\nsRandomInt = NumberToString( INT( RAND( ) * 1000 ));\r\ncDebugFile = GetProcessErrorFileDirectory | cProcess | '.' | cTimeStamp | '.' | sRandomInt ;\r\n\r\n### Initialise Debug ###\r\n\r\nIf( pDebug >= 1 );\r\n\r\n  # Set debug file name\r\n  sDebugFile = cDebugFile | 'Prolog.debug';\r\n\r\n  # Log start time\r\n  AsciiOutput( sDebugFile, 'Process Started: ' | TimSt( Now, '\\d-\\m-\\Y \\h:\\i:\\s' ) );\r\n\r\n  # Log parameters\r\n  AsciiOutput( sDebugFile, 'Parameters: pDimension       : ' | pDimension );\r\n  AsciiOutput( sDebugFile, '            pSourceSub          : ' | pSourceSub );\r\n  AsciiOutput( sDebugFile, '            pTargetSub         : ' | pTargetSub );\r\n\r\nEndIf;\r\n\r\n### Validate Parameters ###\r\n\r\nnErrors = 0;\r\n\r\n# Validate dimension\r\nIf( Trim( pDimension ) @= '' );\r\n  nErrors = 1;\r\n  sMessage = 'No dimension specified';\r\n  If( pDebug >= 1 );\r\n    AsciiOutput( sDebugFile, sMessage );\r\n  EndIf;\r\n  DataSourceType = 'NULL';\r\n  ItemReject( sMessage );\r\nEndIf;\r\nIf( DimensionExists( pDimension ) = 0 );\r\n  nErrors = 1;\r\n  sMessage = 'Invalid dimension: ' | pDimension;\r\n  If( pDebug >= 1 );\r\n    AsciiOutput( sDebugFile, sMessage );\r\n  EndIf;\r\n  DataSourceType = 'NULL';\r\n  ItemReject( sMessage );\r\nEndIf;\r\n\r\n# Validate subset\r\nIf( Trim( pSourceSub ) @= '' );\r\n  nErrors = 1;\r\n  sMessage = 'No source subset specified';\r\n  If( pDebug >= 1 );\r\n    AsciiOutput( sDebugFile, sMessage );\r\n  EndIf;\r\n  DataSourceType = 'NULL';\r\n  ItemReject( sMessage );\r\nEndIf;\r\nIf( SubsetExists( pDimension , pSourceSub ) = 0 );\r\n  nErrors = 1;\r\n  sMessage = 'Invalid source subset : ' | pDimension;\r\n  If( pDebug >= 1 );\r\n    AsciiOutput( sDebugFile, sMessage );\r\n  EndIf;\r\n  DataSourceType = 'NULL';\r\n  ItemReject( sMessage );\r\nEndIf;\r\n\r\n### Create Target Subset ###\r\n\r\nIf( SubsetExists( pDimension, pTargetSub ) = 1 );\r\n  SubsetDeleteAllElements( pDimension, pTargetSub );\r\nElse;\r\n   SubsetCreate( pDimension , pTargetSub );\r\nEndIf;\r\n\r\nnElementPosition = 0;\r\n\r\nDatasourceNameForServer = pDimension;\r\nDatasourceNameForClient = pDimension;\r\nDatasourceType = 'SUBSET';\r\nDatasourceDimensionSubset = pSourceSub;", "MetadataProcedure": "\r\n#****Begin: Generated Statements***\r\n#****End: Generated Statements****\r\n\r\n\r\n################################################################\r\n##~~Copyright bedrocktm1.org 2013 www.bedrocktm1.org/how-to-licence.php Ver 3.0.2~~##\r\n################################################################\r\n\r\n\r\n\r\nnElementPosition = nElementPosition + 1;\r\n\r\n\r\nSubsetElementInsert( pDimension , pTargetSub , vElement , nElementPosition );", "DataSource": {"dataSourceNameForServer": "}Cubes", "dataSourceNameForClient": "}Cubes", "Type": "TM1DimensionSubset", "subset": "All"}, "EpilogProcedure": "\r\n#****Begin: Generated Statements***\r\n#****End: Generated Statements****\r\n\r\n################################################################\r\n##~~Copyright bedrocktm1.org 2013 www.bedrocktm1.org/how-to-licence.php Ver 3.0.2~~##\r\n################################################################\r\n\r\n### Initialise Debug ###\r\n\r\nIf( pDebug >= 1 );\r\n\r\n  # Set debug file name\r\n  sDebugFile = cDebugFile | 'Epilog.debug';\r\n\r\nEndIf;\r\n\r\n### Finalise Debug ###\r\n\r\nIf( pDebug >= 1 );\r\n\r\n  # Log errors\r\n  If( nErrors <> 0 );\r\n    AsciiOutput( sDebugFile, 'Errors Occurred' );\r\n  EndIf;\r\n\r\n  # Log finish time\r\n  AsciiOutput( sDebugFile, 'Process Finished: ' | TimSt( Now, '\\d-\\m-\\Y \\h:\\i:\\s' ) );\r\n\r\nEndIf;\r\n\r\n### If errors occurred terminate process with a major error status ###\r\n\r\nIf( nErrors <> 0 );\r\n  ProcessQuit;\r\nEndIf;\r\n\r\n### End Epilog ###", "VariablesUIData": ["VarType=32\fColType=827\f"]}