{"Parameters": [{"Prompt": "List of Clients Seperated by Delimiter", "Type": "String", "Value": "", "Name": "pClients"}, {"Prompt": "Initial Password", "Type": "String", "Value": "", "Name": "pPassword"}, {"Prompt": "Maximum Ports", "Type": "Numeric", "Value": 5, "Name": "pMaxPorts"}, {"Prompt": "Delimiter", "Type": "String", "Value": "&", "Name": "pDelimiter"}, {"Prompt": "Debug Mode", "Type": "Numeric", "Value": 0, "Name": "pDebug"}], "DataProcedure": "\r\n#****Begin: Generated Statements***\r\n#****End: Generated Statements****\r\n", "Variables": [], "HasSecurityAccess": true, "UIData": "CubeAction=1511\fDataAction=1503\fCubeLogChanges=0\f", "Name": "Bedrock.Security.Client.Create", "PrologProcedure": "\r\n#****Begin: Generated Statements***\r\n#****End: Generated Statements****\r\n\r\n#####################################################################################\r\n##~~Copyright bedrocktm1.org 2011 www.bedrocktm1.org/how-to-licence.php Ver 3.0.2~~##\r\n#####################################################################################\r\n\r\n# This process will create clients, assign a password and max ports\r\n\r\n# Notes:\r\n# - Multiple clients can be specified seperated by a delimiter\r\n# - If client already exists then the process will not attempt to re-create it but will reset password and max ports\r\n\r\n\r\n### Constants ###\r\n\r\ncProcess = 'Bedrock.Security.Client.Create';\r\ncTimeStamp = TimSt( Now, '\\Y\\m\\d\\h\\i\\s' );\r\nsRandomInt = NumberToString( INT( RAND( ) * 1000 ));\r\ncDebugFile = GetProcessErrorFileDirectory | cProcess | '.' | cTimeStamp | '.' | sRandomInt ;\r\n\r\n\r\n### Initialise Debug ###\r\n\r\nIf( pDebug >= 1 );\r\n\r\n  # Set debug file name\r\n  sDebugFile = cDebugFile | 'Prolog.debug';\r\n\r\n  # Log start time\r\n  AsciiOutput( sDebugFile, 'Process Started: ' | TimSt( Now, '\\d-\\m-\\Y \\h:\\i:\\s' ) );\r\n\r\n  # Log parameters\r\n  AsciiOutput( sDebugFile, 'Parameters: pClients: ' | pClients );\r\n  AsciiOutput( sDebugFile, '            pPassword: ' | pPassword );\r\n  AsciiOutput( sDebugFile, '            pMaxPorts: ' | NumberToString( pMaxPorts ) );\r\n  AsciiOutput( sDebugFile, '            pDelimiter: ' | pDelimiter );\r\n\r\nEndIf;\r\n\r\n\r\n### Validate Parameters ###\r\n\r\nnErrors = 0;\r\n\r\n# If blank delimiter specified then convert to default\r\nIf( pDelimiter @= '' );\r\n  pDelimiter = '&';\r\nEndIf;\r\n\r\n# If no clients have been specified then terminate process\r\nIf( Trim( pClients ) @= '' );\r\n  nErrors = 1;\r\n  sMessage = 'No clients specified';\r\n  If( pDebug >= 1 );\r\n    AsciiOutput( sDebugFile, sMessage );\r\n  EndIf;\r\n  ItemReject( sMessage );\r\nEndIf;\r\n\r\n\r\n### Split pClients into individual Clients and add ###\r\n\r\nsClients = pClients;\r\nnDelimiterIndex = 1;\r\n\r\nWhile( nDelimiterIndex <> 0 );\r\n  nDelimiterIndex = Scan( pDelimiter, sClients );\r\n  If( nDelimiterIndex = 0 );\r\n    sClient = sClients;\r\n  Else;\r\n    sClient = Trim( SubSt( sClients, 1, nDelimiterIndex - 1 ) );\r\n    sClients = Trim( Subst( sClients, nDelimiterIndex + Long(pDelimiter), Long( sClients ) ) );\r\n  EndIf;\r\n  # Don't attempt to add a blank client\r\n  If( sClient @<> '' );\r\n    If( DimIx( '}Clients', sClient ) = 0 );\r\n      If( pDebug >= 1 );\r\n        AsciiOutput( sDebugFile, 'Client: ' | sClient | ' OK' );\r\n      EndIf;\r\n      If( pDebug <= 1 );\r\n        AddClient( sClient );\r\n      EndIf;\r\n    Else;\r\n      If( pDebug >= 1 );\r\n        AsciiOutput( sDebugFile, 'Client: ' | sClient | ' already exists' );\r\n      EndIf;\r\n    EndIf;\r\n  EndIf;\r\nEnd;\r\n\r\nIf( pDebug <= 1 );\r\n  DimensionSortOrder( '}Clients', 'ByName', 'Ascending', 'ByName' , 'Ascending' );\r\nEndIf;\r\n\r\n\r\n### End Prolog ###", "MetadataProcedure": "\r\n#****Begin: Generated Statements***\r\n#****End: Generated Statements****\r\n", "DataSource": {"Type": "None"}, "EpilogProcedure": "\r\n#****Begin: Generated Statements***\r\n#****End: Generated Statements****\r\n\r\n#####################################################################################\r\n##~~Copyright bedrocktm1.org 2011 www.bedrocktm1.org/how-to-licence.php Ver 3.0.2~~##\r\n#####################################################################################\r\n\r\n\r\n### Initialise Debug ###\r\n\r\nIf( pDebug >= 1 );\r\n\r\n  # Set debug file name\r\n  sDebugFile = cDebugFile | 'Epilog.debug';\r\n\r\nEndIf;\r\n\r\n\r\n### Update password and max ports ###\r\n\r\nIf( pDebug <= 1 );\r\n\r\n  sClients = pClients;\r\n  nDelimiterIndex = 1;\r\n\r\n  While( nDelimiterIndex <> 0 );\r\n    nDelimiterIndex = Scan( pDelimiter, sClients );\r\n    If( nDelimiterIndex = 0 );\r\n      sClient = sClients;\r\n    Else;\r\n      sClient = Trim( SubSt( sClients, 1, nDelimiterIndex - 1 ) );\r\n      sClients = Trim( Subst( sClients, nDelimiterIndex + Long(pDelimiter), Long( sClients ) ) );\r\n    EndIf;\r\n    If( DimIx( '}Clients', sClient ) <> 0 );\r\n      AssignClientPassword( sClient, pPassword );\r\n      CellPutN( pMaxPorts, '}ClientProperties', sClient, 'MaximumPorts' );\r\n    EndIf;\r\n  End;\r\n\r\nEndIf;\r\n\r\n\r\n### Finalise Debug ###\r\n\r\nIf( pDebug >= 1 );\r\n\r\n  # Log errors\r\n  If( nErrors <> 0 );\r\n    AsciiOutput( sDebugFile, 'Errors Occurred' );\r\n  EndIf;\r\n\r\n  # Log finish time\r\n  AsciiOutput( sDebugFile, 'Process Finished: ' | TimSt( Now, '\\d-\\m-\\Y \\h:\\i:\\s' ) );\r\n\r\nEndIf;\r\n\r\n\r\n### If errors occurred terminate process with a major error status ###\r\n\r\nIf( nErrors <> 0 );\r\n  ProcessQuit;\r\nEndIf;\r\n\r\n\r\n### End Epilog ###", "VariablesUIData": []}