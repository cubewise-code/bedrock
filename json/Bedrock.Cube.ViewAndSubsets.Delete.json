{"Parameters": [{"Prompt": "Cube Name", "Type": "String", "Value": "", "Name": "pCube"}, {"Prompt": "View Name", "Type": "String", "Value": "", "Name": "pView"}, {"Prompt": "Subset Name", "Type": "String", "Value": "", "Name": "pSubset"}, {"Prompt": "Delete temporary view and Subset ( 0 = Retain View and Subsets 1 = Delete View and Subsets 2 = Delete View only )", "Type": "Numeric", "Value": 1, "Name": "pMode"}, {"Prompt": "Debug", "Type": "Numeric", "Value": 0, "Name": "pDebug"}], "DataProcedure": "\r\n#****Begin: Generated Statements***\r\n#****End: Generated Statements****\r\n", "Variables": [], "HasSecurityAccess": true, "UIData": "CubeAction=1511\fDataAction=1503\fCubeLogChanges=0\f", "Name": "Bedrock.Cube.ViewAndSubsets.Delete", "PrologProcedure": "\r\n#****Begin: Generated Statements***\r\n#****End: Generated Statements****\r\n\r\n#####################################################################################\r\n##~~Copyright bedrocktm1.org 2011 www.bedrocktm1.org/how-to-licence.php Ver 3.0.2~~##\r\n#####################################################################################\r\n\r\n# This process deletes a view and all subsets that have the same name\r\n\r\ncProcess = 'Bedrock.Cube.ViewAndSubsets.Delete';\r\ncTimeStamp = TimSt( Now, '\\Y\\m\\d\\h\\i\\s' );\r\nsRandomInt = NumberToString( INT( RAND( ) * 1000 ));\r\ncDebugFile = GetProcessErrorFileDirectory | cProcess | '.' | cTimeStamp | '.' | sRandomInt ;\r\nnErrors = 0;\r\n\r\nIf( pDebug >= 1 );\r\n\r\n  # Set debug file name\r\n  sDebugFile = cDebugFile | 'Prolog.debug';\r\n\r\n  # Log start time\r\n  AsciiOutput( sDebugFile, 'Process Started: ' | TimSt( Now, '\\d-\\m-\\Y \\h:\\i:\\s' ) );\r\n\r\n  # Log parameters\r\n  AsciiOutput( sDebugFile, 'Parameters: pCube  : ' | pCube );\r\n  AsciiOutput( sDebugFile, '            pView  : ' | pView );\r\n  AsciiOutput( sDebugFile, '            pSubset: ' | pSubset );\r\n  AsciiOutput( sDebugFile, '            pMode  : ' | NumberToString( pMode) );\r\n\r\nEndIf;\r\n\r\n### Validate Paramters ##\r\nIF(\r\npMode = 0);\r\n  If( pDebug >= 1 );\r\n    sMessage = 'Mode 0: Do not destroy views and subsets.';\r\n    AsciiOutput( sDebugFile, sMessage );\r\n  EndIf;\r\n  ProcessBreak;\r\nENDIF;\r\n\r\nIf( Trim( pCube ) @= '' );\r\n  If( pDebug >= 1 );\r\n    sMessage = 'No cube specified';\r\n    AsciiOutput( sDebugFile, sMessage );\r\n  EndIf;\r\n  ProcessQuit;\r\nEndIf;\r\n\r\n\r\nIf( pView @= '' & pSubset @= '' );\r\n  If( pDebug >= 1 );\r\n    sMessage = 'No view or subset name has been provided.';\r\n    AsciiOutput( sDebugFile, sMessage );\r\n  EndIf;\r\n  ProcessQuit;\r\nElseIf( pView @<> '' & pSubset @= '' );\r\n  ## Use the nominated view name for the subset name.\r\n  cView = pView;\r\n  cSubset = pView;\r\nElseIf( pView @= '' & pSubset @<> '' );\r\n  ## Use the nominated subset name for the view name.\r\n  cView = pSubset;\r\n  cSubset = pSubset;\r\nElse;\r\n  cView = pView;\r\n  cSubset = pSubset;\r\nEndIf;\r\n\r\n\r\n## Clean up view\r\nIf( pDebug >= 1 );\r\n    AsciiOutput( sDebugFile, 'Destroying view ' | cView | ' on cube ' | pCube );\r\nEndIf;\r\nIf( pDebug <= 1 );\r\n    ViewDestroy(pCube, cView);\r\nEndIf;\r\n\r\n\r\n## Clean up subsets\r\nIF(\r\npMode = 1);\r\n  If( pDebug >= 1 );\r\n    sMessage = 'Destroying subset ' | cSubset | ' for the ' | cView | ' view.' ;\r\n    AsciiOutput( sDebugFile, sMessage );\r\n  EndIf;\r\n\r\n  nDimCount = 0;\r\n  i = 1;\r\n  sDimName = TabDim( pCube, i );\r\n  While( sDimName @<> '' );\r\n    If( SubsetExists (sDimName, cSubset) = 1 );\r\n      If( pDebug >= 1 );\r\n          AsciiOutput( sDebugFile, 'Destroying subset ' | cSubset | ' on dimension ' | sDimName );\r\n      EndIf;\r\n      If( pDebug <= 1 );\r\n          SubsetDestroy( sDimName, cSubset );\r\n      EndIf;\r\n    EndIf;\r\n    sDimName = TabDim( pCube, i );\r\n    i = i + 1;\r\n  End;\r\nENDIF;", "MetadataProcedure": "\r\n#****Begin: Generated Statements***\r\n#****End: Generated Statements****\r\n", "DataSource": {"Type": "None"}, "EpilogProcedure": "\r\n#****Begin: Generated Statements***\r\n#****End: Generated Statements****\r\n\r\n\r\n#####################################################################################\r\n##~~Copyright bedrocktm1.org 2011 www.bedrocktm1.org/how-to-licence.php Ver 3.0.2~~##\r\n#####################################################################################\r\n\r\n\r\n### Initialise Debug ###\r\n\r\nIf( pDebug >= 1 );\r\n\r\n  # Set debug file name\r\n  sDebugFile = cDebugFile | 'Epilog.debug';\r\n\r\n  # Log errors\r\n  If( nErrors <> 0 );\r\n    AsciiOutput( sDebugFile, 'Errors Occurred' );\r\n  EndIf;\r\n\r\n  # Log finish time\r\n  AsciiOutput( sDebugFile, 'Process Finished: ' | TimSt( Now, '\\d-\\m-\\Y \\h:\\i:\\s' ) );\r\n\r\nEndIf;\r\n\r\n\r\n### If errors occurred terminate process with a major error status ###\r\n\r\nIf( nErrors <> 0 );\r\n  ProcessQuit;\r\nEndIf;\r\n\r\n\r\n### End Epilog ###\r\n\r\n\r\n\r\n\r\n", "VariablesUIData": []}