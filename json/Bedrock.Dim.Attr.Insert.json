{"Parameters": [{"Prompt": "Dimension Name", "Type": "String", "Value": "", "Name": "pDimension"}, {"Prompt": "Previous Attribute", "Type": "String", "Value": "", "Name": "pPrevAttr"}, {"Prompt": "Attribute Name", "Type": "String", "Value": "", "Name": "pAttribute"}, {"Prompt": "Attribute Type", "Type": "String", "Value": "", "Name": "pAttributeType"}, {"Prompt": "Debug Mode", "Type": "Numeric", "Value": 0, "Name": "pDebug"}], "DataProcedure": "\r\n#****Begin: Generated Statements***\r\n#****End: Generated Statements****\r\n", "Variables": [], "HasSecurityAccess": true, "UIData": "CubeAction=1511\fDataAction=1503\fCubeLogChanges=0\f", "Name": "Bedrock.Dim.Attr.Insert", "PrologProcedure": "\r\n#****Begin: Generated Statements***\r\n#****End: Generated Statements****\r\n\r\n#####################################################################################\r\n##~~Copyright bedrocktm1.org 2011 www.bedrocktm1.org/how-to-licence.php Ver 3.0.2~~##\r\n#####################################################################################\r\n\r\n### Constants ###\r\n\r\ncProcess = 'Bedrock.Dim.Attr.Insert';\r\ncTimeStamp = TimSt( Now, '\\Y\\m\\d\\h\\i\\s' );\r\nsRandomInt = NumberToString( INT( RAND( ) * 1000 ));\r\ncDebugFile = GetProcessErrorFileDirectory | cProcess | '.' | cTimeStamp | '.' | sRandomInt ;\r\n\r\n\r\n### Initialise Debug ###\r\n\r\nIf( pDebug >= 1 );\r\n\r\n  # Set debug file name\r\n  sDebugFile = cDebugFile | 'Prolog.debug';\r\n\r\n  # List parameters\r\n  AsciiOutput( sDebugFile, 'Parameters: pDimension     : ' | pDimension );\r\n  AsciiOutput( sDebugFile, '            pPrevAttr      : ' | pPrevAttr );\r\n  AsciiOutput( sDebugFile, '            pAttribute     : ' | pAttribute );\r\n  AsciiOutput( sDebugFile, '            pAttributeType : ' | pAttributeType );\r\n\r\nEndIf;\r\n\r\n\r\n### Validate Parameters ###\r\n\r\n# Validate dimension\r\nIf( Trim( pDimension ) @= '' );\r\n  If( pDebug >= 1 );\r\n    AsciiOutput( sDebugFile, 'No dimension specified' );\r\n  EndIf;\r\n  ProcessQuit;\r\nEndIf;\r\nIf( DimensionExists( pDimension ) = 0 );\r\n If( pDebug >= 1 );\r\n    AsciiOutput( sDebugFile, 'Dimension: ' | pDimension | ' does not exist' );\r\n  EndIf;\r\n  ProcessQuit;\r\nEndIf;\r\n\r\n# Validate attribute\r\nIf( Trim( pAttribute ) @= '' );\r\n  If( pDebug >= 1 );\r\n    AsciiOutput( sDebugFile, 'No attribute specified' );\r\n  EndIf;\r\n  ProcessQuit;\r\nEndIf;\r\nIf( DimIx( '}ElementAttributes_' | pDimension, pAttribute ) > 0 );\r\n  ## The attribute to be inserted already exist in the dimension.\r\n  If( pDebug >= 1 );\r\n    AsciiOutput( sDebugFile, 'Attribute: \"' | pAttribute | '\" already exists in dimension: \"' | pDimension | '\"' );\r\n  EndIf;\r\n  ProcessQuit;\r\nEndIf;\r\n\r\n# Validate attribute type\r\npAttributeType = Upper( SubSt( pAttributeType, 1, 1 ) );\r\nIf( pAttributeType @<> 'A' & pAttributeType @<> 'S' & pAttributeType @<> 'N' );\r\n  If( pDebug >= 1 );\r\n    AsciiOutput( sDebugFile, 'Invalid attribute type: '| pAttributeType );\r\n  EndIf;\r\n  ProcessQuit;\r\nEndIf;\r\n\r\n# Validate previous attribute\r\nIf( DimIx( '}ElementAttributes_' | pDimension, pPrevAttr ) = 0 % pPrevAttr @= pAttribute );\r\n  pPrevAttr = '';\r\nEndIf;\r\n\r\n\r\n### Insert Attribute ###\r\n\r\nIf( pDebug <= 1 );\r\n  AttrInsert( pDimension, pPrevAttr, pAttribute, pAttributeType );\r\nEndIf;\r\n\r\n\r\n### End Prolog ###", "MetadataProcedure": "\r\n#****Begin: Generated Statements***\r\n#****End: Generated Statements****\r\n", "DataSource": {"Type": "None"}, "EpilogProcedure": "\r\n#****Begin: Generated Statements***\r\n#****End: Generated Statements****\r\n", "VariablesUIData": []}